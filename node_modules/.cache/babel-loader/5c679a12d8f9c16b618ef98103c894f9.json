{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState } from 'react';\nimport { useEffect } from 'react';\nimport { useBetween } from 'use-between';\nimport { ShareableProbeParams } from './Buttons.js';\nimport { ShareableRunningState, ShareableFinishedState, ShareableOutputState, ShareableWarningState } from './Output.js';\nimport NodeFetch from 'node-fetch';\n\nasync function runOptimizer(finalParams) {\n  var endPoint = process.env.REACT_APP_ENDPOINTADDRESS.concat('/start_optimizer'); //'http://127.0.0.1:8000/start_optimizer';\n\n  finalParams.params.temperature = parseFloat(finalParams.params.temperature);\n  finalParams.params.sodium = parseFloat(finalParams.params.sodium) / 1000.0;\n  finalParams.params.magnesium = parseFloat(finalParams.params.magnesium) / 1000.0;\n  return NodeFetch(endPoint, {\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    method: 'POST',\n    body: JSON.stringify({\n      'probeParams': finalParams\n    })\n  }).then(response => {\n    return response.json();\n  });\n}\n\nconst Optimizer = () => {\n  _s();\n\n  const {\n    probeParams\n  } = useBetween(ShareableProbeParams); // eslint-disable-next-line\n\n  const {\n    running,\n    setRunning\n  } = useBetween(ShareableRunningState);\n  const {\n    setFinished\n  } = useBetween(ShareableFinishedState);\n  const {\n    setOutput\n  } = useBetween(ShareableOutputState);\n  const {\n    setWarning\n  } = useBetween(ShareableWarningState);\n  const [finalParams] = useState(JSON.parse(JSON.stringify(probeParams))); // eslint-disable-next-line\n\n  const [startTime, setStartTime] = useState(0); // Run on mount\n\n  useEffect(() => {\n    let mounted = true;\n    setStartTime(Date.now()); // Start Optimizer\n\n    runOptimizer(finalParams).then(output => {\n      if (mounted) {\n        if (output === {}) {\n          setWarning('Unable to optimize. Please try shifting the target region such that the mutation is centered.');\n          setFinished(false);\n          setRunning(false);\n        } else {\n          setOutput(output);\n          setFinished(true);\n          setRunning(false);\n        }\n      }\n    }).catch(err => {\n      console.log(err);\n      setWarning('Optimization run timed out. Please try again.');\n      setFinished(false);\n      setRunning(false);\n    });\n    return () => {\n      mounted = false;\n    }; // eslint-disable-next-line \n  }, []);\n  return null;\n};\n\n_s(Optimizer, \"Nu/WsWN7WtqwpR5HJq4cvL8mRuM=\", false, function () {\n  return [useBetween, useBetween, useBetween, useBetween, useBetween];\n});\n\n_c = Optimizer;\nexport default Optimizer;\n\nvar _c;\n\n$RefreshReg$(_c, \"Optimizer\");","map":{"version":3,"sources":["/home/leland/MLPractice/snp-lamp-design-client/src/Optimizer.js"],"names":["useState","useEffect","useBetween","ShareableProbeParams","ShareableRunningState","ShareableFinishedState","ShareableOutputState","ShareableWarningState","NodeFetch","runOptimizer","finalParams","endPoint","process","env","REACT_APP_ENDPOINTADDRESS","concat","params","temperature","parseFloat","sodium","magnesium","headers","method","body","JSON","stringify","then","response","json","Optimizer","probeParams","running","setRunning","setFinished","setOutput","setWarning","parse","startTime","setStartTime","mounted","Date","now","output","catch","err","console","log"],"mappings":"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","sourcesContent":["import { useState } from 'react';\nimport { useEffect } from 'react';\nimport { useBetween } from 'use-between';\nimport { ShareableProbeParams } from './Buttons.js';\nimport { ShareableRunningState, ShareableFinishedState, ShareableOutputState, ShareableWarningState } from './Output.js';\nimport NodeFetch from 'node-fetch';\n\nasync function runOptimizer(finalParams) {\n    var endPoint = process.env.REACT_APP_ENDPOINTADDRESS.concat('/start_optimizer'); //'http://127.0.0.1:8000/start_optimizer';\n    finalParams.params.temperature = parseFloat(finalParams.params.temperature);\n    finalParams.params.sodium = parseFloat(finalParams.params.sodium)/1000.0;\n    finalParams.params.magnesium = parseFloat(finalParams.params.magnesium)/1000.0;\n    return NodeFetch(endPoint,\n    {\n        headers: { 'Content-Type': 'application/json' },\n        method: 'POST',\n        body: JSON.stringify({'probeParams': finalParams})\n    }).then(response => {\n        return response.json();\n    })\n}\n\nconst Optimizer = () => {\n\n    const { probeParams } = useBetween(ShareableProbeParams);\n    // eslint-disable-next-line\n    const { running, setRunning } = useBetween(ShareableRunningState);\n    const { setFinished } = useBetween(ShareableFinishedState);\n    const { setOutput } = useBetween(ShareableOutputState);\n    const { setWarning } = useBetween(ShareableWarningState);\n    const [finalParams, ] = useState(JSON.parse(JSON.stringify(probeParams)));\n    // eslint-disable-next-line\n    const [startTime, setStartTime] = useState(0);\n\n    // Run on mount\n    useEffect(() => {\n        let mounted = true;\n        setStartTime(Date.now());\n        // Start Optimizer\n        runOptimizer(finalParams)\n        .then(output => {\n            if(mounted) {\n                if(output === {}) {\n                    setWarning('Unable to optimize. Please try shifting the target region such that the mutation is centered.');\n                    setFinished(false);\n                    setRunning(false);\n                }\n                else {\n                    setOutput(output);\n                    setFinished(true);\n                    setRunning(false);\n                }\n            }\n        }).catch(err => {\n            console.log(err);\n            setWarning('Optimization run timed out. Please try again.');\n            setFinished(false);\n            setRunning(false);\n        })\n\n        return () => {\n            mounted = false;\n        }\n    // eslint-disable-next-line \n    }, []);\n\n    return null;\n};\n\nexport default Optimizer;"]},"metadata":{},"sourceType":"module"}